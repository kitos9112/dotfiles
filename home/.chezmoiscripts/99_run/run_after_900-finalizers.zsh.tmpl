{{- if or (eq .chezmoi.os "linux") (eq .chezmoi.os "darwin") -}}
#!/usr/bin/env zsh

set -ev pipefail

# 5. Update and upgrade brew packages

$(brew --prefix)/bin/brew update || echo "Brew not found on path"
$(brew --prefix)/bin/brew upgrade  || echo "Brew not found on path"

# 6. Update all ASDF plugins
asdf plugin update --all || echo "ASDF not found on path"

# 7. Install/update all ASDF package versions using libraries installed by brew
LDFLAGS="-Wl,-rpath,$(brew --prefix openssl)/lib" \
 CPPFLAGS="-I$(brew --prefix openssl)/include" \
 CONFIGURE_OPTS="--with-openssl=$(brew  --prefix openssl)" \
 asdf install

{{ end -}}
